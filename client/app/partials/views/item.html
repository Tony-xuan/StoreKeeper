<app-details-modal>
  <span ng-controller="ItemController">
    <div class="modal-body">
      <app-details-modal-navbar>
        <span class="navbar-brand"><i class="fa fa-cube"></i> {{ 'Item' | translate }} #{{ rowData.id }}</span>
        <span class="navbar-brand" ng-bind="rowData.name"></span>
      </app-details-modal-navbar>

      <div class="details-modal-content">
        <div class="container-fluid">
          <div class="row">

            <!-- Item details -->
            <form name="itemForm" class="form-horizontal" app-confirm-on-exit="itemForm.$dirty" app-modal-id="modalId">
              <app-details-modal-panel>
                <app-form-typeahead app-name="vendor" app-model="item.vendor" app-label="'Vendor' | translate" app-data-source="vendor as vendor.name for vendor in $parent.vendors" app-create-callback="createVendor()" app-placeholder="'Enter vendor' | translate" app-required="'Vendor is required' | translate" app-loading-spinner="loadingVendors" app-creating-spinner="creatingVendor"></app-form-typeahead>
                <app-form-input app-name="articleNumber" app-model="item.article_number" app-label="'Article no.' | translate" app-placeholder="'Enter article number' | translate" app-required="'Article number is required' | translate"></app-form-input>
                <app-form-input app-name="name" app-model="item.name" app-label="'Name' | translate" app-placeholder="'Enter name of item' | translate" app-required="'Name is required' | translate"></app-form-input>
                <app-form-typeahead app-name="unit" app-model="item.unit" app-label="'Unit' | translate" app-data-source="unit as unit.unit for unit in $parent.units" app-create-callback="createUnit()" app-placeholder="'Enter unit' | translate" app-required="'Unit is required' | translate" app-loading-spinner="loadingUnits" app-creating-spinner="creatingUnit"></app-form-typeahead>
              </app-details-modal-panel>
            </form>

            <!-- Meta -->
            <app-details-modal-panel>
              <app-label app-label="'Current Quantity' | translate" app-object-id="foo">
                <input name="current_quantity" type="string" class="form-control field-quantity" value="{{ item.quantity }} {{ item.unit.unit }}" disabled>
              </app-label>
            </app-details-modal-panel>

            <!-- Barcodes -->
            <form name="barcodesForm">
              <app-details-modal-panel>
                <table class="table">
                  <thead>
                    <tr>
                      <th class="field-barcode" translate>Barcode</th>
                      <th class="field-quantity field-title" translate>Quantity</th>
                      <th class="field-simple-checkbox" translate>On Labels</th>
                      <th class="field-simple-button"></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr ng-repeat="barcode in barcodes">
                      <td class="field-barcode">
                        <input name="barcode" ng-model="barcode.barcode" type="string" class="form-control field-barcode" placeholder="'Barcode' | translate" autocomplete="off" required />
                      </td>
                      <td class="field-quantity">
                        <div class="input-group">
                          <input name="quantity" ng-model="barcode.quantity" type="number" min="1" class="form-control field-quantity" placeholder="'Barcode quantity' | translate" required />
                          <div class="input-group-addon field-unit" ng-bind="item.unit.unit"></div>
                        </div>
                      <td class="field-simple-checkbox">
                        <app-checkbox app-name="itemMain" app-model="barcode.main" app-tooltip="'Use the selected on labels' | translate"></app-checkbox>
                      </td>
                      <td class="field-simple-button">
                        <button type="button" ng-click="downloadLabel(barcode.id)" class="btn btn-default btn-sm"><i class="fa fa-barcode"></i></button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </app-details-modal-panel>
            </form>

          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <app-spinner ng-if="savingItem"></app-spinner>
      <button type="button" class="btn btn-primary" ng-disabled="!itemForm.$dirty || savingItem" ng-click="saveChanges()" translate>Save</button>
      <button type="button" class="btn btn-default" ng-click="discardChanges()" translate>Cancel</button>
    </div>

  </span>
</app-details-modal>
